Anexos
======

Anexo 1: Muestra de resultados obtenidos
----------------------------------------

A continuación se expone una muestra de los resultados obtenidos
de los análisis realizados.

Latencia:

.. code-block:: bash

    Thread 0 Interval: 600
        0:       0:      12
        0:       1:       8
        0:       2:       7
        0:       3:       7
        0:       4:      10
        0:       5:       8
        0:       6:       8
        0:       7:       9
        0:       8:       7
        0:       9:       7
        0:      10:       7
        0:      11:       7
        0:      12:       7
        0:      13:       9
        0:      14:       7
        0:      15:       7
        0:      16:       9
        0:      17:       7
        0:      18:       7
        0:      19:       7
        0:      20:      10
        0:      21:       8
        0:      22:       7
        0:      23:       7
        0:      24:       7
        0:      25:       7
        0:      26:       9
        0:      27:       7
        0:      28:       7

Throughput:

.. code-block:: bash

    ^[[35m[1635685759.599018]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37msend_message            ^[[m | ^[[33m[** <<SER>> **]^[[m        | client_key: 0x262A35A2, len: 13
    ^[[35m[1635685760.051717]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37mrecv_message            ^[[m | ^[[33m[==>> SER <<==]^[[m        | client_key: 0x262A35A2, len: 508
    ^[[35m[1635685760.051991]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37msend_message            ^[[m | ^[[33m[** <<SER>> **]^[[m        | client_key: 0x262A35A2, len: 13
    ^[[35m[1635685760.095816]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37mrecv_message            ^[[m | ^[[33m[==>> SER <<==]^[[m        | client_key: 0x262A35A2, len: 508
    ^[[35m[1635685760.096039]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37msend_message            ^[[m | ^[[33m[** <<SER>> **]^[[m        | client_key: 0x262A35A2, len: 13
    ^[[35m[1635685760.097978]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37mrecv_message            ^[[m | ^[[33m[==>> SER <<==]^[[m        | client_key: 0x262A35A2, len: 52
    ^[[35m[1635685760.098142]^[[m debug    | ^[[34mDataWriter.cpp    ^[[m | ^[[37mwrite                   ^[[m | ^[[33m[** <<DDS>> **]^[[m        | client_key: 0x00000000, len: 1033
    ^[[35m[1635685760.098277]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37msend_message            ^[[m | ^[[33m[** <<SER>> **]^[[m        | client_key: 0x262A35A2, len: 13
    ^[[35m[1635685760.552689]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37mrecv_message            ^[[m | ^[[33m[==>> SER <<==]^[[m        | client_key: 0x262A35A2, len: 508
    ^[[35m[1635685760.552845]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37msend_message            ^[[m | ^[[33m[** <<SER>> **]^[[m        | client_key: 0x262A35A2, len: 13
    ^[[35m[1635685760.596692]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37mrecv_message            ^[[m | ^[[33m[==>> SER <<==]^[[m        | client_key: 0x262A35A2, len: 508
    ^[[35m[1635685760.596904]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37msend_message            ^[[m | ^[[33m[** <<SER>> **]^[[m        | client_key: 0x262A35A2, len: 13
    ^[[35m[1635685760.599166]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37mrecv_message            ^[[m | ^[[33m[==>> SER <<==]^[[m        | client_key: 0x262A35A2, len: 52
    ^[[35m[1635685760.599352]^[[m debug    | ^[[34mDataWriter.cpp    ^[[m | ^[[37mwrite                   ^[[m | ^[[33m[** <<DDS>> **]^[[m        | client_key: 0x00000000, len: 1033
    ^[[35m[1635685760.599486]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37msend_message            ^[[m | ^[[33m[** <<SER>> **]^[[m        | client_key: 0x262A35A2, len: 13
    ^[[35m[1635685761.057626]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37mrecv_message            ^[[m | ^[[33m[==>> SER <<==]^[[m        | client_key: 0x262A35A2, len: 508
    ^[[35m[1635685761.057882]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37msend_message            ^[[m | ^[[33m[** <<SER>> **]^[[m        | client_key: 0x262A35A2, len: 13
    ^[[35m[1635685761.102167]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37mrecv_message            ^[[m | ^[[33m[==>> SER <<==]^[[m        | client_key: 0x262A35A2, len: 508
    ^[[35m[1635685761.102401]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37msend_message            ^[[m | ^[[33m[** <<SER>> **]^[[m        | client_key: 0x262A35A2, len: 13
    ^[[35m[1635685761.104181]^[[m debug    | ^[[34mSerialAgentLinux.cpp^[[m | ^[[37mrecv_message            ^[[m | ^[[33m[==>> SER <<==]^[[m        | client_key: 0x262A35A2, len: 52
    ^[[35m[1635685761.104368]^[[m debug    | ^[[34mDataWriter.cpp    ^[[m | ^[[37mwrite                   ^[[m | ^[[33m[** <<DDS>> **]^[[m        | client_key: 0x00000000, len: 1033

Consumo de meoria:

.. figure:: Fotos/consumo_de_memoria.png
    :width: 600px
    :align: center
    
    Resultados de "htop" al ejecutar la aplicación

Anexo 2: Script de python para la generación de gráficas
--------------------------------------------------------

.. code:: python

    from gc import collect
    import seaborn as sns
    import pandas as pd
    import numpy as np
    import matplotlib.pyplot as plt

    sns.set_theme(style="darkgrid")


    def gen_plot_for_latency(data_file):
        df = pd.read_csv(
            data_file + ".dat",
            skiprows=3,
            delimiter=r":\s+",
            header=None,
            usecols=[2],
            names=["latency"],
            engine="python",
        )

        latency_df = df.drop(df[df.latency < 4].index)

        sns.displot(data=latency_df, x="latency", kind="kde")
        plt.savefig(data_file + "_dist_kde.png", dpi=300)

        sns.histplot(data=latency_df, x="latency", discrete=True)
        plt.savefig(data_file + "_hist.png", dpi=300)


    def gen_plot_for_tp(data_info, axes):
        data_file, description, fil, col = data_info
        df = pd.read_csv(data_file + ".dat", delimiter=r"\s+")
        rel = sns.relplot(
            ax=axes[fil, col],
            x="Frequency",
            y="Throughput",
            data=df,
            kind="line",
            marker="o",
        )
        plt.xscale("log", base=2)
        plt.savefig(data_file + ".png", dpi=300)


    data_files = [
        "latency_serial_best-effort",
        "latency_serial_reliable",
        "latency_wifi_best-effort",
        "latency_wifi_reliable",
        "latency_best_effort_Wi-Fi_interference",
        "latency_reliable_Wi-Fi_interference",
    ]


    for data_file in data_files:
        gen_plot_for_latency(data_file)

    data_infos = [
        ("throughput_serial_best_effort", "Conexión en serie, modo best-effort", 0, 0),
        ("throughput_serial_reliable", "Conexión en serie, modo reliable", 0, 1),
        ("throughput_wifi_best_effort", "Conexión Wi-Fi, modo best-effort", 1, 0),
        ("throughput_wifi_reliable", "Conexión Wi-Fi, modo reliable", 1, 1),
    ]


    for data_info in data_infos:
        fig, axes = plt.subplots(2, 2)
        gen_plot_for_tp(data_info, axes)


Anexo 3: Glosario y abreviaturas
--------------------------------

- ROS: Sistema operativo de robots

- IoT: Internet de las cosas

- RTOS: Sistema operativo en tiemo real

- Framework: Entorno de trabajo

- Firmware: Programa que controla los circuitos electrónicos de un dispositivo

- Middleware: Software intermedio entre dispositivos y plataformas de software

- Throughput: Tasa de transferencia efectiva

- Topic: Tópico del mensaje

- Publisher: Editor de un topic

- Subscriber: Suscriptor de un topic

- API: Interfaz de programación de aplicaciones

- DDS: Servicio de distribución de datos

- XCDR: Dispositivos de recursos extremadamente limitados

- UDP: Protocolo de datagrama de usuario

- TCP: Protocolo de control de transmisión

- POSIX: Interfaz de sistema operativo portable

- OTT: Servicios de libre transmisión

- UART: Transmisor-Receptor Asíncrono Universal

- MIMO: Múltiple entrada, múltiple salida